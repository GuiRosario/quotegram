<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gerador de Citações Estéticas</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;400;600&family=Lora:ital,wght@0,400;0,600;1,400&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap"
    rel="stylesheet" />

  <!-- Html2Canvas Library (para gerar a imagem) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <!-- Phosphor Icons -->
  <script src="https://unpkg.com/@phosphor-icons/web"></script>

  <style>
    /* Font Classes */
    .font-playfair {
      font-family: 'Playfair Display', serif;
    }

    .font-lora {
      font-family: 'Lora', serif;
    }

    .font-inter {
      font-family: 'Inter', sans-serif;
    }

    .font-cinzel {
      font-family: 'Cinzel', serif;
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1;
    }

    ::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #94a3b8;
    }

    /* Hide content while loading to prevent FOUC */
    body {
      opacity: 0;
      animation: fadeIn 0.5s forwards;
    }

    @keyframes fadeIn {
      to {
        opacity: 1;
      }
    }
  </style>
</head>

<body class="bg-slate-50 text-slate-800 font-inter min-h-screen flex flex-col">
  <!-- Navbar -->
  <nav class="bg-white border-b border-slate-200 px-6 py-4 flex items-center justify-between sticky top-0 z-50">
    <div class="flex items-center gap-2 text-indigo-600">
      <i class="ph-fill ph-quotes text-2xl"></i>
      <span class="font-bold text-lg tracking-tight">QuoteGram</span>
    </div>
    <a href="#" class="text-sm text-slate-500 hover:text-indigo-600 transition-colors">Criar Post</a>
  </nav>

  <main class="flex-grow container mx-auto px-4 py-8 flex flex-col lg:flex-row gap-8 items-start justify-center">
    <!-- Controls Section (Left/Top) -->
    <div class="w-full lg:w-1/3 space-y-6 bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
      <div class="space-y-4">
        <h2 class="font-semibold text-slate-700 flex items-center gap-2">
          <i class="ph ph-pencil-simple"></i> Conteúdo
        </h2>

        <div>
          <label class="block text-xs font-medium text-slate-500 mb-1">Frase</label>
          <textarea id="input-quote" rows="4"
            class="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-all resize-none"
            placeholder="Digite sua frase aqui...">
O segredo da vida não é ter tudo que você quer, mas amar tudo que você tem.</textarea>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-xs font-medium text-slate-500 mb-1">Autor</label>
            <input id="input-author" type="text"
              class="w-full p-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"
              placeholder="Nome do Autor" value="George Orwell" />
          </div>
          <div>
            <label class="block text-xs font-medium text-slate-500 mb-1">Livro (Opcional)</label>
            <input id="input-book" type="text"
              class="w-full p-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"
              placeholder="Título do Livro" value="1984" />
          </div>
        </div>
      </div>

      <hr class="border-slate-100" />

      <!-- Personalization -->
      <div class="space-y-4">
        <h2 class="font-semibold text-slate-700 flex items-center gap-2">
          <i class="ph ph-palette"></i> Estilo
        </h2>

        <!-- Theme/Background Selector -->
        <div>
          <label class="block text-xs font-medium text-slate-500 mb-2">Tema</label>
          <div class="grid grid-cols-5 gap-2">
            <button onclick="setTheme('bg-white text-slate-900', '')"
              class="w-10 h-10 rounded-full bg-white border border-slate-300 hover:scale-110 transition-transform ring-2 ring-transparent focus:ring-indigo-500"
              title="Minimalista"></button>
            <button onclick="setTheme('bg-slate-900 text-white', 'border-slate-700')"
              class="w-10 h-10 rounded-full bg-slate-900 border border-slate-700 hover:scale-110 transition-transform ring-2 ring-transparent focus:ring-indigo-500"
              title="Dark"></button>
            <button onclick="setTheme('bg-gradient-to-br from-indigo-500 to-purple-600 text-white', 'border-white/20')"
              class="w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 hover:scale-110 transition-transform ring-2 ring-transparent focus:ring-indigo-500"
              title="Aurora"></button>
            <button
              onclick="setTheme('bg-gradient-to-tr from-amber-200 to-yellow-500 text-amber-900', 'border-amber-900/10')"
              class="w-10 h-10 rounded-full bg-gradient-to-tr from-amber-200 to-yellow-500 hover:scale-110 transition-transform ring-2 ring-transparent focus:ring-indigo-500"
              title="Gold"></button>
            <button
              onclick="setTheme('bg-[url(https://images.unsplash.com/photo-1507842217159-a28f2d79e756?q=80&w=1000&auto=format&fit=crop)] bg-cover bg-center text-white relative isolate', 'border-white/20', true)"
              class="w-10 h-10 rounded-full bg-stone-500 bg-[url(https://images.unsplash.com/photo-1507842217159-a28f2d79e756?q=80&w=100&auto=format&fit=crop)] bg-cover hover:scale-110 transition-transform ring-2 ring-transparent focus:ring-indigo-500"
              title="Textura Papel"></button>
          </div>
        </div>

        <!-- Font Selector -->
        <div>
          <label class="block text-xs font-medium text-slate-500 mb-2">Fonte</label>
          <div class="flex gap-2 bg-slate-100 p-1 rounded-lg">
            <button onclick="setFont('font-playfair')"
              class="flex-1 py-1.5 text-sm rounded bg-white shadow-sm text-slate-700 font-playfair hover:bg-slate-50 transition-colors">
              Clássica
            </button>
            <button onclick="setFont('font-lora')"
              class="flex-1 py-1.5 text-sm rounded hover:bg-white hover:shadow-sm text-slate-600 font-lora transition-all">
              Serifa
            </button>
            <button onclick="setFont('font-inter')"
              class="flex-1 py-1.5 text-sm rounded hover:bg-white hover:shadow-sm text-slate-600 font-inter transition-all">
              Moderna
            </button>
            <button onclick="setFont('font-cinzel')"
              class="flex-1 py-1.5 text-sm rounded hover:bg-white hover:shadow-sm text-slate-600 font-cinzel transition-all">
              Épica
            </button>
          </div>
        </div>

        <!-- Alignment -->
        <div>
          <label class="block text-xs font-medium text-slate-500 mb-2">Alinhamento</label>
          <div class="flex gap-2">
            <button onclick="setAlignment('text-left')" class="p-2 rounded hover:bg-slate-100 text-slate-600">
              <i class="ph ph-text-align-left"></i>
            </button>
            <button onclick="setAlignment('text-center')"
              class="p-2 rounded hover:bg-slate-100 text-slate-600 bg-slate-100">
              <i class="ph ph-text-align-center"></i>
            </button>
            <button onclick="setAlignment('text-right')" class="p-2 rounded hover:bg-slate-100 text-slate-600">
              <i class="ph ph-text-align-right"></i>
            </button>
          </div>
        </div>

        <!-- Adjustments -->
        <div class="space-y-3 pt-2">
          <label class="block text-xs font-medium text-slate-500">Ajustes</label>

          <!-- Font Size -->
          <div>
            <div class="flex justify-between text-xs text-slate-400 mb-1">
              <span>Tamanho da Fonte</span>
              <span id="font-size-value">30px</span>
            </div>
            <input type="range" id="input-font-size" min="16" max="64" value="30"
              class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600" />
          </div>

          <!-- Image Height -->
          <div>
            <div class="flex justify-between text-xs text-slate-400 mb-1">
              <span>Altura da Imagem</span>
              <span id="height-value">600px</span>
            </div>
            <input type="range" id="input-height" min="400" max="1000" step="10" value="600"
              class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600" />
          </div>
        </div>
      </div>

      <!-- Download Button -->
      <button onclick="downloadImage()" id="download-btn"
        class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-4 rounded-xl shadow-lg shadow-indigo-200 transition-all flex items-center justify-center gap-2 mt-4">
        <i class="ph ph-download-simple text-lg"></i>
        Baixar PNG
      </button>
    </div>

    <!-- Preview Section (Right/Bottom) -->
    <div
      class="w-full lg:w-2/3 flex flex-col items-center justify-center bg-slate-100/50 rounded-2xl border border-slate-200 p-8 min-h-[500px]">
      <div class="mb-4 text-sm text-slate-400 font-medium">
        Pré-visualização
      </div>

      <!-- The Card to Capture -->
      <div id="capture-container" class="shadow-2xl transition-all duration-300">
        <div id="preview-card"
          class="w-[400px] h-[500px] sm:w-[500px] sm:h-[600px] bg-white text-slate-900 p-12 flex flex-col justify-between items-center text-center font-playfair relative overflow-hidden">
          <!-- Overlay for bg images -->
          <div id="card-overlay" class="absolute inset-0 bg-black/40 hidden pointer-events-none z-0"></div>

          <!-- Decorative Icon Top -->
          <div class="z-10 opacity-50 mb-4">
            <i class="ph-fill ph-quotes text-4xl"></i>
          </div>

          <!-- Quote Text -->
          <div class="z-10 flex-grow flex items-center justify-center w-full">
            <p id="preview-text" class="text-2xl sm:text-3xl leading-relaxed font-medium break-words max-w-full">
              "O segredo da vida não é ter tudo que você quer, mas amar tudo
              que você tem."
            </p>
          </div>

          <!-- Author & Book Info -->
          <div class="z-10 mt-8 w-full border-t pt-6 opacity-90 transition-colors border-slate-200 flex flex-col gap-1"
            id="preview-footer">
            <p id="preview-author" class="text-sm uppercase tracking-widest font-bold font-inter">
              George Orwell
            </p>
            <p id="preview-book" class="text-xs italic opacity-80 font-lora">
              1984
            </p>
          </div>
        </div>
      </div>

      <p class="mt-6 text-xs text-slate-400">
        Dica: Use emojis ou quebras de linha para estilizar ainda mais.
      </p>
    </div>
  </main>

  <!-- Success Toast -->
  <div id="toast"
    class="fixed bottom-5 right-5 bg-emerald-500 text-white px-6 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 flex items-center gap-2 z-50">
    <i class="ph-bold ph-check-circle"></i>
    <span>Imagem baixada com sucesso!</span>
  </div>

  <script>
    // DOM Elements
    const inputs = {
      quote: document.getElementById('input-quote'),
      author: document.getElementById('input-author'),
      book: document.getElementById('input-book'),
      fontSize: document.getElementById('input-font-size'),
      height: document.getElementById('input-height'),
    };

    const previews = {
      text: document.getElementById('preview-text'),
      author: document.getElementById('preview-author'),
      book: document.getElementById('preview-book'),
      card: document.getElementById('preview-card'),
      footer: document.getElementById('preview-footer'),
      overlay: document.getElementById('card-overlay'),
    };

    // State
    let currentFont = 'font-playfair';
    let currentAlign = 'text-center';

    // Update Text Live
    function updatePreview() {
      previews.text.innerText = inputs.quote.value
        ? `"${inputs.quote.value}"`
        : '';
      previews.author.innerText = inputs.author.value || '';

      if (inputs.book.value) {
        previews.book.innerText = inputs.book.value;
        previews.book.style.display = 'block';
      } else {
        previews.book.style.display = 'none';
      }
    }

    [inputs.quote, inputs.author, inputs.book].forEach((input) => {
      input.addEventListener('input', updatePreview);
    });

    // Size & Height Listeners
    inputs.fontSize.addEventListener('input', (e) => {
      const size = e.target.value + 'px';
      previews.text.style.fontSize = size;
      document.getElementById('font-size-value').innerText = size;
    });

    inputs.height.addEventListener('input', (e) => {
      const height = e.target.value + 'px';
      previews.card.style.height = height;
      document.getElementById('height-value').innerText = height;
    });

    // Styling Functions
    function setTheme(classes, borderClass, hasImage = false) {
      // Reset base classes but keep dimensions and layout
      previews.card.className = `w-[400px] h-[500px] sm:w-[500px] sm:h-[600px] p-12 flex flex-col justify-between items-center relative overflow-hidden ${currentFont} ${currentAlign}`;

      // Add new theme classes
      const classList = classes.split(' ');
      classList.forEach((c) => previews.card.classList.add(c));

      // Handle borders
      previews.footer.className = `z-10 mt-8 w-full border-t pt-6 opacity-90 transition-colors flex flex-col gap-1 ${borderClass ? borderClass : 'border-slate-200'
        }`;

      // Handle Image Overlay
      if (hasImage) {
        previews.overlay.classList.remove('hidden');
      } else {
        previews.overlay.classList.add('hidden');
      }
    }

    function setFont(fontClass) {
      previews.card.classList.remove(currentFont);
      currentFont = fontClass;
      previews.card.classList.add(currentFont);
    }

    function setAlignment(alignClass) {
      previews.card.classList.remove(currentAlign);

      // Also update flex alignments
      previews.card.classList.remove(
        'items-center',
        'items-start',
        'items-end'
      );

      if (alignClass === 'text-center')
        previews.card.classList.add('items-center');
      if (alignClass === 'text-left')
        previews.card.classList.add('items-start');
      if (alignClass === 'text-right')
        previews.card.classList.add('items-end');

      currentAlign = alignClass;
      previews.card.classList.add(currentAlign);
    }

    // Download Function
    function downloadImage() {
      const btn = document.getElementById('download-btn');
      const originalText = btn.innerHTML;

      // Loading State
      btn.innerHTML = `<i class="ph ph-spinner animate-spin text-lg"></i> Gerando...`;
      btn.disabled = true;

      const element = document.getElementById('preview-card');

      // Use html2canvas
      html2canvas(element, {
        scale: 3, // High resolution
        useCORS: true, // Allow external images
        backgroundColor: null, // Transparent background if not set
        logging: false,
      })
        .then((canvas) => {
          // Create download link
          const link = document.createElement('a');
          link.download = `citacao-${Date.now()}.png`;
          link.href = canvas.toDataURL('image/png');
          link.click();

          // Show Success Toast
          const toast = document.getElementById('toast');
          toast.classList.remove('translate-y-20', 'opacity-0');
          setTimeout(() => {
            toast.classList.add('translate-y-20', 'opacity-0');
          }, 3000);

          // Reset Button
          btn.innerHTML = originalText;
          btn.disabled = false;
        })
        .catch((err) => {
          console.error(err);
          alert('Ocorreu um erro ao gerar a imagem. Tente novamente.');
          btn.innerHTML = originalText;
          btn.disabled = false;
        });
    }

    // Initialize
    updatePreview();
    // Default font buttons highlighting logic would go here in a larger app
  </script>
</body>

</html>